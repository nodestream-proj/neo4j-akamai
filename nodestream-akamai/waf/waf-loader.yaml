
write_batch_sizes: 100

extractor:
  implementation: etwpipeline.tools:FixtureFileExtractor
  arguments:
    files:
      - akamai_waf.json

transformers:
  - implementation: nodestream.interpreters:Interpreter
    arguments:
      interpretations:
        - type: source_node
          configId: !!python/jmespath configId
          node_type: akamai_waf_config
        - type: metadata
          configName: !!python/jmespath configName
          configId:  !!python/jmespath configId
          productionVersion: !!python/jmespath productionVersion
          status: !!python/jmespath status
        - type: relationship
          iterate_on: !!python/jmespath policies[*]
          search: !!python/jmespath policyId
          related_node_type: akamai_waf_policy
          related_field_name: policyId
          relationship_type: DEFINED_BY
          outbound: false
            

writers:
  - implementation: etwpipeline.writers:LoggerWriter
    arguments:
      logger_name: "akamai-waf"
      level: DEBUG
  - !include ../neo4j_writer.yaml
