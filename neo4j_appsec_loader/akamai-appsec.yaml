resolvers: 
  - implementation: etwpipeline.declarative.resolvers:EnvironmentResolver
write_batch_sizes: 100

extractor:
  implementation: etwpipeline.tools:FixtureFileExtractor
  arguments:
    files:
      - akamai_appsec.json

transformers:
  - implementation: neo4j_ingest.pipeline_components:Interpreter
    arguments:
      interpretations:
        - type: source_node
          fqdn: !!python/jmespath hostname
          node_type: Endpoint
        - type: metadata
          configName: !!python/jmespath configuration.name
          configId: !!python/jmespath configuration.id
          version: !!python/jmespath configuration.version
          policyNames: !!python/jmespath policyNames[0]
        - type: relationship
          search: !!python/jmespath hostname
          relationship_type: PROTECTED_BY
          outbound: false  

writers:
  - implementation: etwpipeline.writers:LoggerWriter
    arguments:
      logger_name: "akamai-appsec"
      level: DEBUG
  - !include ../neo4j_writer.yaml
